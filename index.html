<!DOCTYPE html>

<html lang="es">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<title>MECARIEGO – Escuela de Riego Inteligente</title>
<link href="https://fonts.googleapis.com/css?family=Roboto:400,700&amp;display=swap" rel="stylesheet"/>
<link href="styles.css" rel="stylesheet"/>
</head>
<body>
<header>
<div class="container header-content">
<a class="logo" href="#"><img alt="MECARIEGO logo" src="assets/logo.png" style="height:48px;"/></a>
<button aria-label="Abrir menú" class="nav-toggle"><span></span><span></span><span></span></button>
<nav aria-label="Menú principal" class="nav">
<ul>
<li><a href="#propuesta">Propuesta</a></li>
<li><a href="#app">App</a></li>
<li><a href="#alianzas">Alianzas</a></li>
<li><a href="#curso">Curso</a></li>
<li><a href="#testimonios">Testimonios</a></li>
<li><a href="#faq">FAQ</a></li>
<li><a class="cta" href="#inscripcion">Inscríbete</a></li>
</ul>
</nav>
</div>
</header>
<section aria-label="Hero" class="hero" id="hero" role="region">
<div class="hero-overlay"></div>
<div class="container">
<h1>DEBMAGRO — MECARIEGO: La Escuela de Riego Inteligente</h1>
<p class="lead">Programa técnico-práctico para optimizar el uso del agua en fincas, con formación certificada, pilotos in situ y beneficios comerciales. Capacítate con contenidos aplicables, apps de campo y acompañamiento post-instalación.</p>
<a class="btn-primary" href="#inscripcion">Inscríbete a la Escuela de Riego</a>
<!-- Fuente: sintetizado de contenido público de DEBMAGRO (ver sources.txt) -->
<!-- Reemplazar HERO con video oficial si se obtiene: https://www.facebook.com/debmagrosa/videos/2271567149652588/ -->
<div class="micro"><span class="pulse"></span>Aprende con prácticas en campo • Certificación • Acceso a insumos</div></div>
</section>
<!-- Propuesta -->
<section class="seccion propuesta reveal" id="propuesta">
<div class="container">
<h2>Nuestra Propuesta de Valor</h2>
<p>MECARIEGO es una iniciativa de formación aplicada que combina teoría y práctica para la optimización del riego en cultivos. Nuestro enfoque incluye: formación técnica modular, acompañamiento para instalar pilotos, herramientas digitales para el monitoreo y acceso a mercado para insumos y equipos.</p>
<ul class="beneficios">
<li>Formación práctica y certificada en tecnologías de riego.</li>
<li>Implementación de un piloto de riego en tu finca.</li>
<li>Descuentos exclusivos en equipos y consumibles DEBMAGRO.</li>
<li>Asesoría técnica continua por parte de expertos.</li>
</ul>
<div class="benefit-details">
<h3>Beneficios clave</h3>
<ul>
<li><strong>Formación práctica:</strong> módulos con actividades de campo y guías técnicas.</li>
<li><strong>Pilotos en finca:</strong> instalación y medición con soporte técnico para evidenciar ahorros.</li>
<li><strong>Acceso a tecnología:</strong> descuentos en equipos y recomendaciones de proveedores.</li>
<li><strong>Monitoreo continuo:</strong> uso de sensores y alertas para decisiones basadas en datos.</li>
</ul>
</div></div>
</section>
<!-- App -->
<section class="seccion app reveal" id="app">
<div class="container">
<h2>La Escuela y la App</h2>
<p>La plataforma móvil incluye lecciones en video, simuladores de ahorro, PDFs descargables y notificaciones. Pensada para operación offline y monitorización en campo.</p>
<div class="app-features">
<ul>
<li>Videos educativos descargables.</li>
<li>Pruebas rápidas y seguimiento de progreso.</li>
<li>Simulador de costos y ahorro de agua.</li>
<li>Notificaciones vía SMS/WhatsApp.</li>
<li>Biblioteca de recursos (manuales, PDF, checklist).</li>
</ul>
<div class="mockups">
<img alt="Mockup app 1" loading="lazy" src="assets/app_mockup1.png"/>
<img alt="Mockup app 2" loading="lazy" src="assets/app_mockup2.png"/>
<img alt="Mockup app 3" loading="lazy" src="assets/app_mockup3.png"/>
</div>
</div>
</div>
</section>
<!-- Curso (tabs) -->
<section class="seccion curso reveal" id="curso">
<div class="container">
<h2>Programa del Curso</h2>
<div class="tabs">
<ul class="tab-buttons" role="tablist">
<li aria-selected="true" class="active" data-tab="M0" role="tab" tabindex="0">Módulo 0</li>
<li aria-selected="false" class="" data-tab="M1" role="tab" tabindex="-1">Módulo 1</li>
<li aria-selected="false" class="" data-tab="M2" role="tab" tabindex="-1">Módulo 2</li>
<li aria-selected="false" class="" data-tab="M3" role="tab" tabindex="-1">Módulo 3</li>
<li aria-selected="false" class="" data-tab="M4" role="tab" tabindex="-1">Módulo 4</li>
<li aria-selected="false" class="" data-tab="M5" role="tab" tabindex="-1">Módulo 5</li>
</ul>

<div aria-hidden="false" class="active tab-content" id="M0" role="tabpanel">
<h3>Introducción a MECARIEGO y DEBMAGRO</h3>
<p>En este módulo conocerás el origen de MECARIEGO, su alineación con la estrategia de DEBMAGRO y casos de implementación regional. Revisaremos cómo la escuela sirve como puente entre conocimiento técnico y oportunidades comerciales para los productores y empresas. Se mostrará un mapa de cobertura y criterios para seleccionar parcelas piloto.</p>
<p><strong>Objetivos de aprendizaje:</strong> Comprender y aplicar los conceptos básicos y prácticos relacionados con este módulo.</p><p><strong>Contenidos clave:</strong> En este módulo conocerás el origen de MECARIEGO y DEBMAGRO. Se explica la visión, misión y los elementos clave del programa de riego inteligente. También se presentan criterios para seleccionar parcelas piloto y una guía rápida de recursos.</p><p><strong>Actividades:</strong> Lecturas dirigidas, ejercicios prácticos en campo, cuestionario de evaluación y discusión de casos.</p><p><strong>Duración estimada:</strong> 3-5 horas (modalidad autoguiada).</p><p>En este módulo conocerás el origen de MECARIEGO y DEBMAGRO. Se explica la visión, misión y los elementos clave del programa de riego inteligente. También se presentan criterios para seleccionar parcelas piloto y una guía rápida de recursos.</p><p><em>Recursos:</em> Presentación institucional (ver sources.txt).</p><p><a class="btn-secondary" href="assets/module_M0.pdf" rel="noopener" target="_blank">Material de apoyo (PDF)</a></p></div><div aria-hidden="true" class="tab-content" id="M1" role="tabpanel">
<h3>Principios del riego</h3>
<p>Se abordan los fundamentos: balance hídrico, tipos de riego (goteo, microaspersión, aspersión), diseño de emisores y criterios de eficiencia. Incluye ejercicios prácticos de cálculo de dosis hídrica para cultivos representativos y un video de referencia.</p>
<p><strong>Objetivos de aprendizaje:</strong> Comprender y aplicar los conceptos básicos y prácticos relacionados con este módulo.</p><p><strong>Contenidos clave:</strong> Fundamentos técnicos: balance hídrico, evotranspiración, capacidades de campo y cómo estos parámetros influyen en la programación de riego. Incluye ejemplos prácticos con cultivos representativos y ejercicios.</p><p><strong>Actividades:</strong> Lecturas dirigidas, ejercicios prácticos en campo, cuestionario de evaluación y discusión de casos.</p><p><strong>Duración estimada:</strong> 3-5 horas (modalidad autoguiada).</p><p>Fundamentos técnicos: balance hídrico, evotranspiración, capacidades de campo y cómo estos parámetros influyen en la programación de riego. Incluye ejemplos prácticos con cultivos representativos y ejercicios.</p><p><button class="btn-link js-video-btn" data-video-url="https://www.youtube.com/watch?v=WceQJIgA-6U">Ver video de referencia</button></p><p><a class="btn-secondary" href="assets/module_M1.pdf" rel="noopener" target="_blank">Material de apoyo (PDF)</a></p></div><div aria-hidden="true" class="tab-content" id="M2" role="tabpanel">
<h3>Sensores y monitoreo automático</h3>
<p>Descripción y comparación de sensores (capacitivos, tensiométricos, sensores FDR). Configuración de thresholds, telemetría básica, integración con la app para alertas y ejemplos de dashboards con lecturas en tiempo real.</p>
<p><strong>Objetivos de aprendizaje:</strong> Comprender y aplicar los conceptos básicos y prácticos relacionados con este módulo.</p><p><strong>Contenidos clave:</strong> Elementos de un sistema de riego: bombas, tuberías, emisores, sensores y telemetría. Selección de equipos según caudal y presión. Casos de éxito y errores comunes al dimensionar un sistema.</p><p><strong>Actividades:</strong> Lecturas dirigidas, ejercicios prácticos en campo, cuestionario de evaluación y discusión de casos.</p><p><strong>Duración estimada:</strong> 3-5 horas (modalidad autoguiada).</p><p>Elementos de un sistema de riego: bombas, tuberías, emisores, sensores y telemetría. Selección de equipos según caudal y presión. Casos de éxito y errores comunes al dimensionar un sistema.</p><p><a class="btn-secondary" href="assets/module_M2.pdf" rel="noopener" target="_blank">Material de apoyo (PDF)</a></p></div><div aria-hidden="true" class="tab-content" id="M3" role="tabpanel">
<h3>Instalación y mantenimiento del piloto</h3>
<p>Protocolo paso a paso: selección de sitio, alineación de tuberías, instalación de filtro y válvulas, puesta en marcha, mediciones iniciales y programa de mantenimiento preventivo. Incluye checklist descargable y plan de verificación de rendimiento.</p>
<p><strong>Objetivos de aprendizaje:</strong> Comprender y aplicar los conceptos básicos y prácticos relacionados con este módulo.</p><p><strong>Contenidos clave:</strong> Buenas prácticas de operación diaria, rutinas de mantenimiento preventivo, checklist para estaciones de bombeo y consejos para alargar la vida útil de equipos en condiciones tropicales.</p><p><strong>Actividades:</strong> Lecturas dirigidas, ejercicios prácticos en campo, cuestionario de evaluación y discusión de casos.</p><p><strong>Duración estimada:</strong> 3-5 horas (modalidad autoguiada).</p><p>Buenas prácticas de operación diaria, rutinas de mantenimiento preventivo, checklist para estaciones de bombeo y consejos para alargar la vida útil de equipos en condiciones tropicales.</p><p><a href="assets/checklist.pdf" rel="noopener" target="_blank">Descargar checklist (PDF)</a></p></div><div aria-hidden="true" class="tab-content" id="M4" role="tabpanel">
<h3>Casos de éxito y métricas</h3>
<p>Estudios de caso con KPIs de ahorro de agua, incremento de rendimiento y cálculo de ROI. Incluye un ejercicio práctico para estimar meses de recuperación de inversión y gráficos interactivos que muestran resultados antes/después.</p>
<p><strong>Objetivos de aprendizaje:</strong> Comprender y aplicar los conceptos básicos y prácticos relacionados con este módulo.</p><p><strong>Contenidos clave:</strong> Conceptos de automatización: controladores, sensores de humedad, válvulas solenoides y lógica de control. Integración con plataformas móviles y cómo interpretar telemetría para tomar decisiones.</p><p><strong>Actividades:</strong> Lecturas dirigidas, ejercicios prácticos en campo, cuestionario de evaluación y discusión de casos.</p><p><strong>Duración estimada:</strong> 3-5 horas (modalidad autoguiada).</p><p>Conceptos de automatización: controladores, sensores de humedad, válvulas solenoides y lógica de control. Integración con plataformas móviles y cómo interpretar telemetría para tomar decisiones.</p><p>Testimonio: <strong>“Reducimos hasta 40% el uso de agua”</strong> (ejemplo).</p><p><a class="btn-secondary" href="assets/module_M3.pdf" rel="noopener" target="_blank">Material de apoyo (PDF)</a></p></div><div aria-hidden="true" class="tab-content" id="M5" role="tabpanel">
<h3>Evaluación final y certificado</h3>
<p>Estructura de la evaluación: preguntas teóricas, evaluación de evidencia del piloto y criterios para la emisión del certificado digital. Recomendaciones para documentar tu piloto y solicitar la certificación.</p>
<div class="module-quiz">
<button class="btn-primary view-quiz" data-module="M5">Ver cuestionario</button>
<div class="quiz-container" id="quiz-M5" style="display:none; margin-top:12px; border-left:4px solid #0b6b3a; padding:12px; background:#fbfff9;">
<form class="quiz-form" data-module="M5">
<ol>
<li>
<p>¿Cuál es el objetivo principal de la evaluación final del curso?</p>
<label><input name="q1" type="radio" value="a"/> Medir el tiempo de conexión</label><br/>
<label><input name="q1" type="radio" value="b"/> Evaluar la comprensión de conceptos y aplicación en campo</label><br/>
<label><input name="q1" type="radio" value="c"/> Revisar facturas</label><br/>
<label><input name="q1" type="radio" value="d"/> Medir velocidad de internet</label>
</li>
<li>
<p>¿Qué documento se solicita para validar un piloto implementado?</p>
<label><input name="q2" type="radio" value="a"/> Bitácora de campo y reporte técnico</label><br/>
<label><input name="q2" type="radio" value="b"/> Solo fotos</label><br/>
<label><input name="q2" type="radio" value="c"/> Recibo de compra</label><br/>
<label><input name="q2" type="radio" value="d"/> Lista de contactos</label>
</li>
<li>
<p>¿Qué criterio es clave para la emisión del certificado?</p>
<label><input name="q3" type="radio" value="a"/> Haber completado quizzes y evaluación práctica</label><br/>
<label><input name="q3" type="radio" value="b"/> Solo ver videos</label><br/>
<label><input name="q3" type="radio" value="c"/> Haber descargado PDFs</label><br/>
<label><input name="q3" type="radio" value="d"/> Ser cliente antiguo</label>
</li>
</ol>
<p><button class="btn-secondary submit-quiz" type="submit">Enviar respuestas</button> <span class="quiz-result" style="margin-left:12px;"></span></p>
</form>
</div>
</div>
<p><strong>Objetivos de aprendizaje:</strong> Comprender y aplicar los conceptos básicos y prácticos relacionados con este módulo.</p><p><strong>Contenidos clave:</strong> Estructura de la evaluación final: preguntas teóricas, prácticas de campo y criterios para emisión del certificado digital. Recomendaciones para documentar un piloto y elaborar informes técnicos.</p><p><strong>Actividades:</strong> Lecturas dirigidas, ejercicios prácticos en campo, cuestionario de evaluación y discusión de casos.</p><p><strong>Duración estimada:</strong> 3-5 horas (modalidad autoguiada).</p><p>Estructura de la evaluación final: preguntas teóricas, prácticas de campo y criterios para emisión del certificado digital. Recomendaciones para documentar un piloto y elaborar informes técnicos.</p><button class="btn-primary">Solicitar Certificado</button><p><a class="btn-secondary" href="assets/module_M4.pdf" rel="noopener" target="_blank">Material de apoyo (PDF)</a></p></div></div>







</div>






























</section>
<!-- Alianzas -->
<!-- Testimonios -->
<section class="seccion testimonios reveal" id="testimonios">
<div class="container">
<h2>Testimonios</h2>
<div class="cards">
<div class="card">
<img alt="Testimonio 1" loading="lazy" src="assets/testimonial1.jpg"/>
<h3>Juan Pérez</h3>
<p>Productor de pitahaya — "Reducimos 40% el consumo de agua y aumentamos producción."</p>
</div>
<div class="card">
<img alt="Testimonio 2" loading="lazy" src="assets/testimonial2.jpg"/>
<h3>María Sánchez</h3>
<p>Productora de cacao — "La capacitación práctica nos permitió optimizar tiempos y costos."</p>
</div>
</div>
</div>
</section>
<!-- FAQ -->
<section class="seccion faq reveal" id="faq">
<div class="container">
<h2>Preguntas Frecuentes</h2>
<div class="faq-item"><strong>¿Quiénes pueden participar?</strong>
<p>Productores agrícolas de cualquier tamaño.</p>
</div>
<div class="faq-item"><strong>¿Duración?</strong>
<p>5–6 semanas en modalidad online con prácticas en campo.</p>
</div>
<div class="faq-item"><strong>¿Costo?</strong>
<p>Programa patrocinado — ver condiciones en la convocatoria.</p>
</div>
<div class="faq-item"><strong>¿Certificado?</strong>
<p>Sí, certificado digital al aprobar evaluación final.</p>
</div>
<div class="faq-item"><strong>¿Dónde instalo el piloto?</strong>
<p>En una parcela seleccionada en tu finca; recomendamos 0.1–1 ha según cultivo.</p>
</div>
<div class="faq-item"><strong>¿Qué cultivos?</strong>
<p>Aplica a una amplia gama: banano, cacao, pitahaya, hortalizas, etc.</p>
</div>
</div>
</section>
<!-- Inscripción -->
<section class="seccion contacto reveal" id="inscripcion">
<div class="container">
<h2>Inscripción</h2>
<form action="mailto:ventas@debmagro.com" enctype="text/plain" id="formulario" method="post">
<div class="form-grid">
<div class="form-group"><label for="nombre">Nombre completo</label><input id="nombre" name="nombre" required=""/></div>
<div class="form-group"><label for="telefono">Teléfono</label><input id="telefono" name="telefono" required=""/></div>
<div class="form-group"><label for="email">Correo</label><input id="email" name="email" required="" type="email"/></div>
<div class="form-group"><label for="cultivo">Tipo de cultivo</label><input id="cultivo" name="cultivo" required=""/></div>
<div class="form-group"><label for="hectareas">Hectáreas</label><input id="hectareas" min="0" name="hectareas" required="" type="number"/></div>
<div class="form-group"><label for="provincia">Provincia</label><select id="provincia" name="provincia" required=""><option value="">Selecciona</option><option>Guayas</option><option>Los Ríos</option><option>Manabí</option></select></div>
<div class="form-group full"><label for="comentario">Comentarios</label><textarea id="comentario" name="comentario" rows="4"></textarea></div>
</div>
<button class="btn-primary" type="submit">Enviar inscripción</button>
</form>
<div aria-hidden="true" class="modal" id="confirmacion"><div class="modal-content"><p>¡Gracias! Tu inscripción fue enviada (simulada).</p><button class="btn-close">Cerrar</button></div></div>
</div>
</section>
<section class="seccion aliados" id="aliados">
<div class="container">
<h2>Aliados y proveedores</h2>
<p>DEBMAGRO trabaja con aliados estratégicos para ofrecer soluciones completas de riego. A continuación algunos de nuestros socios de confianza:</p>
<div class="allies-grid">
<div class="ally"><img alt="RainBird logo" src="assets/ally_1.png"/><h4>RainBird</h4><p>Fabricante de aspersores y soluciones de riego a gran escala.</p></div>
<div class="ally"><img alt="Netafim logo" src="assets/ally_2.png"/><h4>Netafim</h4><p>Proveedor global de tecnología en riego por goteo y microaspersión.</p></div>
<div class="ally"><img alt="Plastigama logo" src="assets/ally_3.png"/><h4>Plastigama</h4><p>Líder en tuberías y conexiones para sistemas de riego eficientes.</p></div>
<div class="ally"><img alt="Senninger logo" src="assets/ally_4.png"/><h4>Senninger</h4><p>Innovación en emisores y tecnología de riego agrícola de precisión.</p></div>
</div>
</div>
</section>
<section class="seccion casos" id="casos">
<div class="container">
<h2>Casos de éxito</h2>
<p>Proyectos reales donde DEBMAGRO optimizó riego, redujo consumo de agua y aumentó rendimiento:</p>
<div class="cases-grid">
<article class="case">
<img alt="Caso 1" src="assets/caso_1.jpg"/>
<h3>Mejoras en La Primavera</h3>
<p><strong>Contexto:</strong> Pequeña finca hortícola con problemas de distribución de agua.</p>
<p><strong>Intervención:</strong> Instalación de riego por goteo y sensores de humedad.</p>
<p><strong>Resultado:</strong> 30% menos agua y 18% más rendimiento en la primera cosecha.</p>
</article>
<article class="case">
<img alt="Caso 2" src="assets/caso_2.jpg"/>
<h3>Modernización en El Paraíso</h3>
<p><strong>Contexto:</strong> Unidad de riego comunitaria con fugas y baja eficiencia.</p>
<p><strong>Intervención:</strong> Reemplazo de tuberías, nuevas bombas y panel de control remoto.</p>
<p><strong>Resultado:</strong> Ahorro energético del 22% y mejor uniformidad de riego.</p>
</article>
<article class="case">
<img alt="Caso 3" src="assets/caso_3.jpg"/>
<h3>Piloto en El Empalme</h3>
<p><strong>Contexto:</strong> Proyecto piloto con cultivos de arroz en parcelas tecnificadas.</p>
<p><strong>Intervención:</strong> Sistema automatizado con telemetría y control por programación.</p>
<p><strong>Resultado:</strong> Mejor manejo hídrico y documentación técnica para réplica.</p>
</article>
</div>
</div>
</section>
<footer class="seccion footer" id="contacto">
<div class="container">
<div class="footer-col">
<div class="contact-card">
<h4>Contacto</h4>
<p style="margin:0;"><strong>DEBMAGRO S.A.</strong> — El Empalme, Ecuador</p>
<p style="margin:0;">Tel: <a href="tel:+593987354150">+593 98 735 4150</a></p>
<p style="margin:0;">Email: <a href="mailto:ventas@debmagro.com">ventas@debmagro.com</a></p>
</div>
</div>
<div class="footer-col">
<h4>Enlaces</h4>
<ul>
<li><a href="#hero">Inicio</a></li>
<li><a href="#curso">Curso</a></li>
<li><a href="#aliados">Aliados</a></li>
<li><a href="#casos">Casos</a></li>
<li><a href="#contacto">Contacto</a></li>
</ul>
</div>
<div class="footer-col">
<h4>Síguenos</h4>
<p><a href="https://www.facebook.com/debmagrosa" rel="noopener" target="_blank">Facebook</a> · <a href="https://www.instagram.com/debmagro/" rel="noopener" target="_blank">Instagram</a></p>
</div>
</div>
<div class="footer-bottom"><p>© 2025 DEBMAGRO S.A. – MECARIEGO (Demo)</p></div>
</footer>
<script src="app.js"></script>
<!-- Certificate modal -->
<div aria-hidden="true" class="modal cert-modal" id="cert-modal" role="dialog" style="display:none;">
<div class="modal-content">
<h3>Solicitar certificado</h3>
<form id="cert-form">
<label>Nombre completo:<br/><input id="cert-name" required="" style="width:100%; padding:8px; margin-top:6px;" type="text"/></label>
<label>Seleccionar módulo:<br/><select id="cert-module" style="width:100%; padding:8px; margin-top:6px;">
<option value="General">Curso MECARIEGO</option>
<option value="M0">Módulo M0</option><option value="M1">Módulo M1</option>
<option value="M2">Módulo M2</option><option value="M3">Módulo M3</option>
<option value="M4">Módulo M4</option><option value="M5">Módulo M5</option>
</select></label>
<p style="margin-top:12px;"><button class="btn-primary" type="submit">Generar certificado (PDF)</button> <button class="btn-secondary" id="cert-close" type="button">Cerrar</button></p>
</form>
</div>
</div>
<!-- jsPDF CDN (for certificate generation) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function(){
  // Restore 'Solicitar certificado' buttons for modules passed previously
  for(var i=0;i<6;i++){
    var key = 'mecariego_quiz_M' + i;
    var stored = localStorage.getItem(key);
    if(stored){
      try{
        var obj = JSON.parse(stored);
        if(obj.pct >= 60){
          // find module panel and append cert button
          var panel = document.getElementById('M' + i);
          if(panel){
            var resultSpan = panel.querySelector('.quiz-result');
            // avoid duplicate
            if(panel.querySelector('.cert-open')) continue;
            var certBtn = document.createElement('button');
            certBtn.textContent = 'Solicitar certificado';
            certBtn.className = 'btn-primary cert-open';
            certBtn.setAttribute('data-module', 'M' + i);
            if(resultSpan) resultSpan.parentNode.appendChild(certBtn);
            else panel.appendChild(certBtn);
          }
        }
      }catch(e){console.log('parse error', e);}
    }
  }
});
// Enhance certificate generation: after saving and downloading, also persist a record
document.addEventListener('click', function(e){
  if(e.target && e.target.classList.contains('cert-open')){
    var mod = e.target.getAttribute('data-module');
    document.getElementById('cert-module').value = mod;
    document.getElementById('cert-modal').style.display = 'block';
    document.getElementById('cert-modal').setAttribute('aria-hidden','false');
  }
});
document.getElementById && document.getElementById('cert-form') && document.getElementById('cert-form').addEventListener('submit', function(e){
  e.preventDefault();
  var name = document.getElementById('cert-name').value.trim();
  var module = document.getElementById('cert-module').value;
  if(!name){ alert('Por favor ingrese su nombre.'); return; }
  const { jsPDF } = window.jspdf;
  var doc = new jsPDF({orientation: 'landscape', unit: 'pt', format: 'letter'});
  doc.setFillColor(11,106,58);
  doc.rect(0,0, doc.internal.pageSize.getWidth(), doc.internal.pageSize.getHeight(), 'F');
  doc.setFillColor(255,255,255);
  doc.roundedRect(40,40, doc.internal.pageSize.getWidth()-80, doc.internal.pageSize.getHeight()-80, 10, 10, 'F');
  doc.setFontSize(28);
  doc.setTextColor(11,106,58);
  doc.text('Certificado de finalización', doc.internal.pageSize.getWidth()/2, 120, {align: 'center'});
  doc.setFontSize(20);
  doc.setTextColor(0,0,0);
  doc.text(name, doc.internal.pageSize.getWidth()/2, 200, {align: 'center'});
  doc.setFontSize(14);
  doc.text('Por haber completado: ' + module, doc.internal.pageSize.getWidth()/2, 240, {align: 'center'});
  var fecha = new Date().toLocaleDateString();
  doc.text('Fecha: ' + fecha, doc.internal.pageSize.getWidth()/2, 270, {align: 'center'});
  doc.setFontSize(10);
  doc.text('DEBMAGRO S.A. — ventas@debmagro.com', doc.internal.pageSize.getWidth()/2, doc.internal.pageSize.getHeight()-60, {align: 'center'});
  var fname = 'Certificado_' + name.replace(/\s+/g,'_') + '.pdf';
  doc.save(fname);
  // persist certificate record
  var certKey = 'mecarigo_cert_' + name.replace(/\s+/g,'_') + '_' + module;
  localStorage.setItem(certKey, JSON.stringify({name: name, module: module, date: new Date().toISOString()}));
  // close modal
  document.getElementById('cert-modal').style.display = 'none';
  document.getElementById('cert-modal').setAttribute('aria-hidden','true');
  alert('Certificado generado y descargado. Registro guardado en su navegador.');
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function(){
  // Toggle quiz visibility only for M5
  document.addEventListener('click', function(e){
    if(e.target && e.target.classList.contains('view-quiz')){
      var cont = document.getElementById('quiz-M5');
      if(cont){
        if(cont.style.display === 'none'){ cont.style.display = 'block'; e.target.textContent = 'Ocultar cuestionario'; }
        else { cont.style.display = 'none'; e.target.textContent = 'Ver cuestionario'; }
      }
    }
  });

  // submit handler for the M5 quiz only
  document.addEventListener('submit', function(e){
    if(e.target && e.target.classList.contains('quiz-form')){
      e.preventDefault();
      var form = e.target;
      // correct answers for M5: q1=b, q2=a, q3=a
      var formData = new FormData(form);
      var score = 0; var total = 3;
      if(formData.get('q1') === 'b') score++;
      if(formData.get('q2') === 'a') score++;
      if(formData.get('q3') === 'a') score++;
      var pct = Math.round((score/total)*100);
      var resultSpan = form.querySelector('.quiz-result');
      if(resultSpan) resultSpan.textContent = 'Resultado: ' + score + '/' + total + ' (' + pct + '%)';
      // store result for M5 only
      localStorage.setItem('mecariego_quiz_M5', JSON.stringify({score: score, total: total, pct: pct, date: new Date().toISOString()}));
      // show certificate button if pass
      if(pct >= 60){
        // avoid duplicates
        if(!document.querySelector('.cert-open[data-module="M5"]')){
          var certBtn = document.createElement('button');
          certBtn.textContent = 'Solicitar certificado';
          certBtn.className = 'btn-primary cert-open';
          certBtn.setAttribute('data-module', 'M5');
          resultSpan.parentNode.appendChild(certBtn);
        }
      }
    }
  });

  // restore cert button if previously passed
  try{
    var stored = localStorage.getItem('mecariego_quiz_M5');
    if(stored){
      var obj = JSON.parse(stored);
      if(obj.pct >= 60){
        if(!document.querySelector('.cert-open[data-module="M5"]')){
          var panel = document.getElementById('M5');
          if(panel){
            var resultSpan = panel.querySelector('.quiz-result');
            var certBtn = document.createElement('button');
            certBtn.textContent = 'Solicitar certificado';
            certBtn.className = 'btn-primary cert-open';
            certBtn.setAttribute('data-module', 'M5');
            if(resultSpan) resultSpan.parentNode.appendChild(certBtn);
            else panel.appendChild(certBtn);
          }
        }
      }
    }
  }catch(e){console.log('restore error', e);}

  // certificate modal open/close
  document.addEventListener('click', function(e){
    if(e.target && e.target.classList.contains('cert-open')){
      document.getElementById('cert-module').value = e.target.getAttribute('data-module') || 'General';
      document.getElementById('cert-modal').style.display = 'block';
      document.getElementById('cert-modal').setAttribute('aria-hidden','false');
    }
    if(e.target && e.target.id === 'cert-close'){
      document.getElementById('cert-modal').style.display = 'none';
      document.getElementById('cert-modal').setAttribute('aria-hidden','true');
    }
  });

  // certificate form submit
  document.getElementById('cert-form').addEventListener('submit', function(e){
    e.preventDefault();
    var name = document.getElementById('cert-name').value.trim();
    var module = document.getElementById('cert-module').value;
    if(!name){ alert('Por favor ingrese su nombre.'); return; }
    const { jsPDF } = window.jspdf;
    var doc = new jsPDF({orientation: 'landscape', unit: 'pt', format: 'letter'});
    doc.setFillColor(11,106,58);
    doc.rect(0,0, doc.internal.pageSize.getWidth(), doc.internal.pageSize.getHeight(), 'F');
    doc.setFillColor(255,255,255);
    doc.roundedRect(40,40, doc.internal.pageSize.getWidth()-80, doc.internal.pageSize.getHeight()-80, 10, 10, 'F');
    doc.setFontSize(28);
    doc.setTextColor(11,106,58);
    doc.text('Certificado de finalización', doc.internal.pageSize.getWidth()/2, 120, {align: 'center'});
    doc.setFontSize(20);
    doc.setTextColor(0,0,0);
    doc.text(name, doc.internal.pageSize.getWidth()/2, 200, {align: 'center'});
    doc.setFontSize(14);
    doc.text('Por haber completado: ' + module, doc.internal.pageSize.getWidth()/2, 240, {align: 'center'});
    var fecha = new Date().toLocaleDateString();
    doc.text('Fecha: ' + fecha, doc.internal.pageSize.getWidth()/2, 270, {align: 'center'});
    doc.setFontSize(10);
    doc.text('DEBMAGRO S.A. — ventas@debmagro.com', doc.internal.pageSize.getWidth()/2, doc.internal.pageSize.getHeight()-60, {align: 'center'});
    var fname = 'Certificado_' + name.replace(/\s+/g,'_') + '.pdf';
    doc.save(fname);
    // persist certificate record
    var certKey = 'mecarigo_cert_' + name.replace(/\s+/g,'_') + '_' + module;
    localStorage.setItem(certKey, JSON.stringify({name: name, module: module, date: new Date().toISOString()}));
    document.getElementById('cert-modal').style.display = 'none';
    document.getElementById('cert-modal').setAttribute('aria-hidden','true');
    alert('Certificado generado y descargado. Registro guardado en su navegador.');
  });
});
</script>
<script>
// Tabs: show one panel at a time. Works with elements that have data-tab attributes.
(function(){
  function activateTabButton(btn){
    var buttons = document.querySelectorAll('[data-tab]');
    buttons.forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    var tabId = btn.getAttribute('data-tab');
    var panels = document.querySelectorAll('.tab-content');
    panels.forEach(p => { p.classList.remove('active'); p.setAttribute('aria-hidden','true'); });
    var panel = document.getElementById(tabId);
    if(panel){ panel.classList.add('active'); panel.setAttribute('aria-hidden','false'); panel
    if(panel){ panel.style.display = 'block'; panel.classList.add('active'); panel.setAttribute('aria-hidden','false'); panel }); }
  }
  document.addEventListener('click', function(e){
    var tb = e.target.closest('[data-tab]');
    if(tb){
      e.preventDefault();
      activateTabButton(tb);
    }
  });
  // Initialize: if no active set, set first data-tab button active
  document.addEventListener('DOMContentLoaded', function(){
    var activeBtn = document.querySelector('[data-tab].active') || document.querySelector('[data-tab]');
    if(activeBtn) activateTabButton(activeBtn);
  });
})();

// FAQ toggle: make robust for different markup inside .faq-item
(function(){
  function toggleItem(item){
    if(!item) return;
    item.classList.toggle('open');
  }
  document.addEventListener('click', function(e){
    var header = e.target.closest('.faq-item h4, .faq-item .faq-toggle, .faq-item strong, .faq-item .question');
    if(header){
      var item = header.closest('.faq-item');
      toggleItem(item);
    }
  });
  // enhance each FAQ item to include a toggle icon if not present
  document.addEventListener('DOMContentLoaded', function(){
    document.querySelectorAll('.faq-item').forEach(function(item){
      if(!item.querySelector('.faq-toggle')){
        var h4 = item.querySelector('h4') || item.querySelector('strong') || item.querySelector('.question');
        if(h4){
          var span = document.createElement('span');
          span.className = 'faq-toggle';
          span.style.cssText = 'float:right;background:#0b6b3a;color:#fff;width:28px;height:28px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;font-weight:bold';
          span.textContent = '+';
          h4.appendChild(span);
        }
      }
    });
  });
})();
</script>
<script>
// Robust tab panel controller: ensures only one module panel is visible at a time.
// Works even if CSS rules are overridden. Uses style.display to force show/hide.
(function(){
  function hideAllPanels(){
    document.querySelectorAll('.tab-content').forEach(function(p){
      p.style.display = 'none';
      p.classList.remove('active');
      p.setAttribute('aria-hidden', 'true');
    });
  }
  function showPanelById(id){
    var panel = document.getElementById(id);
    if(panel){
      panel.style.display = 'block';
      panel.classList.add('active');
      panel.setAttribute('aria-hidden', 'false');
      // scroll into view a bit for better UX
      setTimeout(function(){ panel }, 50);
    }
  }
  document.addEventListener('DOMContentLoaded', function(){
    // Hide all panels and show only the one that has .active or fallback to first panel
    var panels = Array.from(document.querySelectorAll('.tab-content'));
    if(panels.length === 0) return;
    hideAllPanels();
    var active = panels.find(p => p.classList.contains('active')) || panels[0];
    showPanelById(active.id);
    // wire up tab buttons (elements with [data-tab])
    document.querySelectorAll('[data-tab]').forEach(function(btn){
      btn.addEventListener('click', function(e){
        e.preventDefault();
        var target = btn.getAttribute('data-tab');
        // update active class on buttons
        document.querySelectorAll('[data-tab]').forEach(function(b){ b.classList.remove('active'); b.setAttribute('aria-selected','false'); b.setAttribute('tabindex','-1'); });
        btn.classList.add('active');
        btn.setAttribute('aria-selected','true');
        btn.setAttribute('tabindex','0');
        // show correct panel
        hideAllPanels();
        showPanelById(target);
      });
      // keyboard navigation (Enter/Space)
      btn.addEventListener('keydown', function(ev){
        if(ev.key === 'Enter' || ev.key === ' '){
          ev.preventDefault();
          btn.click();
        }
      });
    });
  });
})();
</script>
<script>
// FAQ toggle - robust handler
(function(){
  function toggle(item){
    if(!item) return;
    var isOpen = item.classList.toggle('open');
    // update toggle icon inside header if exists
    var icon = item.querySelector('.faq-toggle');
    if(icon) icon.textContent = isOpen ? '−' : '+';
  }
  document.addEventListener('click', function(e){
    var header = e.target.closest('.faq-item h4, .faq-item .question, .faq-toggle');
    if(header){
      var item = header.closest('.faq-item');
      toggle(item);
    }
  });
  // Ensure FAQ items have a .faq-toggle span for visual affordance
  document.addEventListener('DOMContentLoaded', function(){
    document.querySelectorAll('.faq-item').forEach(function(item){
      var h4 = item.querySelector('h4') || item.querySelector('strong') || item.querySelector('.question');
      if(h4 && !h4.querySelector('.faq-toggle')){
        var span = document.createElement('span');
        span.className = 'faq-toggle';
        span.textContent = '+';
        span.style.cssText = 'float:right;background:#0b6b3a;color:#fff;width:28px;height:28px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;font-weight:bold';
        h4.appendChild(span);
      }
    });
  });
})();
</script>
<script>
// Tab controller (no auto-scroll, no auto-focus). Shows only the selected module panel.
(function(){
  function hideAllPanels(){
    document.querySelectorAll('.tab-content').forEach(function(p){
      p.style.display = 'none';
      p.classList.remove('active');
      p.setAttribute('aria-hidden', 'true');
    });
  }
  function showPanelById(id){
    var panel = document.getElementById(id);
    if(panel){
      panel.style.display = 'block';
      panel.classList.add('active');
      panel.setAttribute('aria-hidden', 'false');
    }
  }
  document.addEventListener('DOMContentLoaded', function(){
    // Hide all panels and show only the one that is marked active, or the first
    var panels = Array.from(document.querySelectorAll('.tab-content'));
    if(panels.length === 0) return;
    hideAllPanels();
    var active = panels.find(p => p.classList.contains('active')) || panels[0];
    if(active) showPanelById(active.id);
    // wire up tab buttons
    document.querySelectorAll('[data-tab]').forEach(function(btn){
      btn.addEventListener('click', function(e){
        e.preventDefault();
        var target = btn.getAttribute('data-tab');
        // update active class on buttons
        document.querySelectorAll('[data-tab]').forEach(function(b){ b.classList.remove('active'); b.setAttribute('aria-selected','false'); b.setAttribute('tabindex','-1'); });
        btn.classList.add('active');
        btn.setAttribute('aria-selected','true');
        btn.setAttribute('tabindex','0');
        // show correct panel without scrolling
        hideAllPanels();
        showPanelById(target);
      });
      btn.addEventListener('keydown', function(ev){ if(ev.key === 'Enter' || ev.key === ' '){ ev.preventDefault(); btn.click(); } });
    });
  });
})();
</script>
</body>
</html>
